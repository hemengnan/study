## 1. 综合对比

| 特性          | RabbitMQ                               | RocketMQ                                                                                    | Kafka                                                                          |
|-------------|----------------------------------------|---------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
| 开发语言        | Erlang                                 | Java                                                                                        | Scala                                                                          |
| 单机吞吐量       | 万                                      | 十万                                                                                          | 十万                                                                             |
| 可用性         | 主从                                     | 分布式                                                                                         | 分布式                                                                            |
| 管理界面        | 比较ok                                   | 不好用                                                                                         | 一般                                                                             |
| 时效性         | us                                     | ms                                                                                          | ms                                                                             |
| 功能特性        | 基于Erlang开发，所以并很强、性能极好、延迟低、管理界面丰富、支持多语言 | 功能比较完善、对扩展比较友好，仅用于Java                                                                      | 只支持主要的功能，像一些消息查询，消息回溯等功能没有提供，毕竟是为大数据准备的                                        |
| 适用场景        | 数据量不大                                  | 大数据量，如订单、交易、流计、消息推送、日志流式处理等场景                                                               | 适用于埋点上报，日志采集、大数据流计算                                                            |
| Broker端消息过滤 | \                                      | 支持Tag标签过滤和SQL表达式过滤                                                                          | \                                                                              |
| 消息查询        | 根据消息id                                 | 根据消息id或者Key查询                                                                               | \                                                                              |
| 消息回溯        | \                                      | 支持按照时间回溯，精度毫秒，例如从一天之前的某个时刻开始重新消费消息                                                          | 理论上可以支持时间或offset回溯，单得修改源码                                                      |
| 路由逻辑        | 基于交换机，可配置复杂路由逻辑，比如死信队列                 | 根据Topic，可以配置过滤消费                                                                            | 根据Topic                                                                        |
| 持久化         | 队列基于内存，只能少量堆积                          | 大量堆积                                                                                        | 大量堆积                                                                           |
| 顺序消息        | \                                      | 支持                                                                                          | 支持                                                                             |
| 消费并行度       | 不影响                                    | 1、顺序消费方式并行度与Kafka一致。 <br/>2、乱序方式并行度取决于消费端的线程数，如Topic配置10个队列，10台机器消费，每台机器100个线程，那么并行度就是1000。 | 依赖Topic配置的分区数，如分区数为10，那么最多10台机器来并行消费，每台机器只能1个线程，或者一台机器启10个线程并行消费。也就是说并行度和分区数一致 |


## 2. 优缺点分析

### 2.1 RabbitMQ

#### 优点：
1. 项目开源，社区活跃，管理界面丰富，适用于中小型公司。
2. Erlang开发，队列基于内存，并发高延迟低，基于AMQP协议支持多语言接入。
3. 特有的交换机模式，支持很多复杂场景的消息路由。

#### 缺点：
1. 源码对Java开发人员不太友好，不好探索。
2. 队列只能支持主备，不能分布式横向扩展，单点问题是硬伤，投递消息如果不在某台虚机上，还需要虚机进行转发请求。
3. 队列基于内存，无法大量堆积消息。
4. 不支持顺序消息，消息消费失败后会重回队列，打乱顺序。



### 2.2 RocketMQ

#### 优点：
1. 基于Java语言开发，看源码方便，可根据场景进行改造。
2. 对比Kafka，额外支持消息查询、回溯、消息重试、延迟等复杂业务场景。
3. 吞吐量相比RabbitMQ高。
4. 分布式架构，可横向扩展。

#### 缺点：
1. 社区不够活跃，Github上讨论的不多。
2. 支持的语言不多。



### 2.2 Kafka

#### 优点：
1. 吞吐量高。
2. 分布式架构，可横向扩展。

#### 缺点：
1. 单机超过64个队列/分区，Load会发生明显的飙高现象，队列越多发送消息响应时间越长。
2. 功能比较简单，主要聚焦于日志场景、流式计算。
3. 对业务的场景支持不够灵活。



























